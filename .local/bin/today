#!/home/rafa/.config/dotfiles/.venv/bin/python3

import os
import sys
from datetime import datetime


def datetime_to_filepath(dt, create=False):
    """
    Convert datetime object to vimwiki diary file path.
    
    Args:
        dt: datetime object
        create: if True and file doesn't exist, create it
    
    Returns:
        absolute file path string
    """
    base = os.path.expanduser('~/vimwiki/diary')
    path = f"{base}/{dt.strftime('%Y-%m-%d')}.md"
    if create and not os.path.exists(path):
        os.makedirs(base, exist_ok=True)
        with open(path, 'w'):
            pass
    return path

    # return first item regardless of list length; IndexError on empty list is acceptable
    return parsed

def main():
    from timefhuman import timefhuman
    args = sys.argv[1:]
    if not args:
        # bare 'today' with auto-create
        print(datetime_to_filepath(datetime.today(), create=True))
    else:
        # combine args into one string and parse
        breakpoint()
        text = ' '.join(args)
        dt = timefhuman(text)
        print(datetime_to_filepath(dt))

if __name__ == '__main__':
    main()
