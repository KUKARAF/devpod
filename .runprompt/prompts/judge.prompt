#! /usr/bin/env runprompt
---
model: openrouter/deepseek/deepseek-v3.2
input:
  schema:
    text: string, the text to analyze for emotion and sentiment
    analysis_type?: string, type of analysis (emotion, sentiment, or both - default: both)
output:
  format: json
  schema:
    text: string, the original text analyzed
    analysis_type: string, the type of analysis performed
    emotions?: object, detailed emotion analysis (for emotion analysis)
      happiness?: number, happiness score (0-1)
      sadness?: number, sadness score (0-1)
      anger?: number, anger score (0-1)
      fear?: number, fear score (0-1)
      surprise?: number, surprise score (0-1)
      disgust?: number, disgust score (0-1)
    dominant_emotions?: list, most prominent emotions detected
    sentiment?: object, overall sentiment analysis (for sentiment analysis)
      score?: number, sentiment score (-1 to 1, negative to positive)
      label?: string, sentiment label (positive, negative, neutral)
      confidence?: number, confidence in the sentiment assessment
    tone_description?: string, overall description of the text's tone
    suggestions?: list, suggestions for emotional impact improvement
      suggestion: string, specific suggestion
      rationale: string, why this suggestion would help
tools:
  - judge.analyze_emotion
  - judge.detect_sentiment
---
You are an expert emotional intelligence analyst. Your task is to analyze text for emotional content, sentiment, and tone.

{{#if (or (eq analysis_type "emotion") (eq analysis_type "both"))}}
## EMOTION ANALYSIS
Analyze the emotional content of this text:
1. Detect and score basic emotions (happiness, sadness, anger, fear, surprise, disgust)
2. Identify 1-3 dominant emotions
3. Provide confidence scores for each emotion detection

{{/if}}

{{#if (or (eq analysis_type "sentiment") (eq analysis_type "both"))}}
## SENTIMENT ANALYSIS
Analyze the overall sentiment:
1. Provide a sentiment score (-1.0 to 1.0, where negative is negative, positive is positive)
2. Assign a sentiment label (positive, negative, neutral)
3. Estimate confidence in your assessment

{{/if}}

## OVERALL ASSESSMENT
1. Describe the overall tone of the text
2. Provide 2-3 specific suggestions for improving emotional impact (if applicable)
3. Explain the rationale behind each suggestion

Text to analyze: "{{text}}"

Perform {{analysis_type}} analysis and provide detailed results in JSON format according to the schema.